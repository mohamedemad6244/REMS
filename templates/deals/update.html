{% extends 'base.html' %}

{% block content %}
<div class="content">
    <h2>Update Deal</h2>
    <form id="dealForm" action="{{ url_for('update_deal', deal_id=deal.Deal_ID) }}" method="POST">
        <div class="form-group">
            <label for="deal_status">Deal Status</label>
            <select name="deal_status" id="deal_status" required>
                <option value="Pending" {% if deal.Deal_Status == 'Pending' %}selected{% endif %}>Pending</option>
                <option value="Completed" {% if deal.Deal_Status == 'Completed' %}selected{% endif %}>Completed</option>
                <option value="Cancelled" {% if deal.Deal_Status == 'Cancelled' %}selected{% endif %}>Cancelled</option>
            </select>
        </div>
        <div class="form-group">
            <label for="act_end_date">Actual End Date</label>
            <input type="date" name="act_end_date" id="act_end_date" value="{{ deal.Act_End_Date }}">
        </div>
        <div class="form-group">
            <label for="property_id">Property ID</label>
            <input type="number" name="property_id" id="property_id" value="{{ deal.Property_ID }}" required>
        </div>
        <div class="form-group">
            <label for="customer_id">Customer ID</label>
            <input type="number" name="customer_id" id="customer_id" value="{{ deal.Customer_ID }}" required>
        </div>
        <div class="form-group">
            <label for="agent_id">Agent ID</label>
            <input type="number" name="agent_id" id="agent_id" value="{{ deal.Agent_ID }}">
        </div>
        <div class="form-group">
            <label for="deal_type">Deal Type</label>
            <select name="deal_type" id="deal_type" required>
                <option value="Cash" {% if deal.Deal_Type == 'Cash' %}selected{% endif %}>Cash</option>
                <option value="Installment" {% if deal.Deal_Type == 'Installment' %}selected{% endif %}>Installment</option>
                <option value="Renting" {% if deal.Deal_Type == 'Renting' %}selected{% endif %}>Renting</option>
            </select>
        </div>
        <!-- Conditional fields -->
        <div id="rentingFields" style="display: {% if deal.Deal_Type == 'Renting' %}block{% else %}none{% endif %};">
            <h3>Renting Deal Details</h3>
            <div class="form-group">
                <label for="rent_start_date">Rent Start Date</label>
                <input type="date" name="rent_start_date" id="rent_start_date" value="{{ deal.Rent_Start_Date }}">
            </div>
            <div class="form-group">
                <label for="rent_end_date">Rent End Date</label>
                <input type="date" name="rent_end_date" id="rent_end_date" value="{{ deal.Rent_End_Date }}">
            </div>
            <div class="form-group">
                <label for="monthly_rent">Monthly Rent</label>
                <input type="number" name="monthly_rent" id="monthly_rent" value="{{ deal.Monthly_Rent }}">
            </div>
            <div class="form-group">
                <label for="security_deposit">Security Deposit</label>
                <input type="number" name="security_deposit" id="security_deposit" value="{{ deal.Security_Deposit }}">
            </div>
        </div>

        <div id="installmentFields" style="display: {% if deal.Deal_Type == 'Installment' %}block{% else %}none{% endif %};">
            <h3>Installment Deal Details</h3>
            <div class="form-group">
                <label for="inst_start_date">Installment Start Date</label>
                <input type="date" name="inst_start_date" id="inst_start_date" value="{{ deal.Inst_Start_Date }}">
            </div>
            <div class="form-group">
                <label for="inst_end_date">Installment End Date</label>
                <input type="date" name="inst_end_date" id="inst_end_date" value="{{ deal.Inst_End_Date }}">
            </div>
            <div class="form-group">
                <label for="total_price">Total Price</label>
                <input type="number" name="total_price" id="total_price" value="{{ deal.Total_Price }}">
            </div>
            <div class="form-group">
                <label for="down_payment">Down Payment</label>
                <input type="number" name="down_payment" id="down_payment" value="{{ deal.Down_Payment }}">
            </div>
            <div class="form-group">
                <label for="frequency">Frequency</label>
                <input type="text" name="frequency" id="frequency" value="{{ deal.Frequency }}">
            </div>
            <div class="form-group">
                <label for="installment_amount">Installment Amount</label>
                <input type="number" name="installment_amount" id="installment_amount" value="{{ deal.Installment_Amount }}">
            </div>
        </div>

        <div id="cashFields" style="display: {% if deal.Deal_Type == 'Cash' %}block{% else %}none{% endif %};">
            <h3>Cash Deal Details</h3>
            <div class="form-group">
                <label for="deal_price">Deal Price</label>
                <input type="number" name="deal_price" id="deal_price" value="{{ deal.Deal_Price }}">
            </div>
            <div class="form-group">
                <label for="deal_date">Deal Date</label>
                <input type="date" name="deal_date" id="deal_date" value="{{ deal.Deal_Date }}">
            </div>
        </div>

        <div class="form-group">
            <label for="upfront_deposit">Upfront Deposit</label>
            <input type="number" name="upfront_deposit" id="upfront_deposit" value="{{ deal.Upfront_Deposit }}">
        </div>
        <div class="form-group">
            <label for="note">Note</label>
            <textarea name="note" id="note">{{ deal.Note }}</textarea>
        </div>

        <button type="submit">Update Deal</button>
    </form>
</div>
{% endblock %}
